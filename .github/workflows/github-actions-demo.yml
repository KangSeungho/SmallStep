name: GitHub Actions Demo
on:
  push:
    branches:
      - develop-compose
jobs:
  commit-message-parse:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Get commit message
        run: |
          COMMIT_MESSAGE=$(git log --format=%B -n 1 ${{ github.sha }})
          echo "::set-output name=commit_message::$COMMIT_MESSAGE"
          
      - name: Check commit message
        id: check_commit
        run: |
          if [[ "${{ steps.get_commit_message.outputs.commit_message }}" == *"[QA]"* ]]; then
            echo "Commit message contains '[QA]'. Triggering Firebase upload..."
            echo "::set-output name=should_upload::true"
          else
            echo "Commit message does not contain '[QA]'. No action triggered."
            echo "::set-output name=should_upload::false"
          fi
          
      - name: Qa commit message parse
        if: steps.check_commit.outputs.should_upload == 'true'
        run: |
          echo "You can upload the app from Firebase App Distribution"